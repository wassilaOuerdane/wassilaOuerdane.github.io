
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>3.1. Indirect interactions &#8212; MultiAgent Systems 2020-2021 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="3.4. Interactions in the Mesa library" href="part-6.html" />
    <link rel="prev" title="3. Interaction mechanisms : models and implementation" href="cours-3.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="part-6.html" title="3.4. Interactions in the Mesa library"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="cours-3.html" title="3. Interaction mechanisms : models and implementation"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MultiAgent Systems 2020-2021 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="indirect-interactions">
<h1>3.1. Indirect interactions<a class="headerlink" href="#indirect-interactions" title="Permalink to this headline">¶</a></h1>
<p>Indirect interactions is the main interaction mechanism in MAS. Remember the PRS architecture:</p>
<a class="reference internal image-reference" href="_images/PRS.png"><img alt="_images/PRS.png" class="align-center" src="_images/PRS.png" style="width: 500px;" /></a>
<p>Agents can only act (and perceive) from their environment. The idea behind indirect interactions is that agents that act on shared variables in the environment interact through this variable, even if they don’t have the intention to do so.</p>
<div class="section" id="blackboards">
<h2>1. Blackboards<a class="headerlink" href="#blackboards" title="Permalink to this headline">¶</a></h2>
<p>The first multiagent platforms in the 90s implement <em>blackboards</em> in the environment. A blackboard is an array (or a python list) in which agents can write information that can be used by other agents.</p>
<p>Let us consider the Alice-Bob example again:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">threading</span> <span class="kn">import</span> <span class="n">Thread</span>

<span class="k">class</span> <span class="nc">Environment</span><span class="p">:</span>
    <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">def</span> <span class="nf">act</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">v</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>
        <span class="k">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">v</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">perceive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">v</span>

<span class="k">class</span> <span class="nc">Agent</span><span class="p">(</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">preferred_value</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
        <span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pv</span> <span class="o">=</span> <span class="n">preferred_value</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">procedural_loop</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">procedural_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">perceive</span><span class="p">()</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pv</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">act</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">Runtime</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">e</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">()</span>
        <span class="n">Agent</span><span class="p">(</span><span class="s2">&quot;Alice&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="n">Agent</span><span class="p">(</span><span class="s2">&quot;Bob&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>

<span class="n">Runtime</span><span class="p">()</span>
</pre></div>
</div>
<p>Both agents act on a variable named “v” in the environment, which they try to maintain to their preferred value (note that we used the asynchronous version, but that was for a change; it would be the same in a synchronous implementation or in a Mesa model). The list of variables has to be defined in the environment, which does not make our implementation very <em>generic</em> or reusable. Providing the environment with a blackboard can achieve this feature.</p>
<p>In the following example, we implemented a <strong>blackboard as a Python dictionary</strong> in which agent can set variable values.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Environment</span><span class="p">:</span>
    <span class="n">blackboard</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">def</span> <span class="nf">act</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">blackboard</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">def</span> <span class="nf">perceive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">blackboard</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">blackboard</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">None</span>
</pre></div>
</div>
<p>Based on this, the code for Alice and Bob agents could be:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Agent</span><span class="p">(</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">preferred_value</span><span class="p">,</span> <span class="n">env</span><span class="p">):</span>
        <span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pv</span> <span class="o">=</span> <span class="n">preferred_value</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">procedural_loop</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">procedural_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">perceive</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pv</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">act</span><span class="p">(</span><span class="s2">&quot;v&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">pv</span><span class="p">)</span>
</pre></div>
</div>
<p>The idea is that all agents can now share variable or exchange any sort of information on the blackboard.</p>
</div>
<div class="section" id="from-blackboards-to-stigmergy">
<h2>2. From Blackboards to Stigmergy<a class="headerlink" href="#from-blackboards-to-stigmergy" title="Permalink to this headline">¶</a></h2>
<p>Blackboards architectures however were not very popular. There are two main reasons. The first one is that they assume a centralised mechanism (the blackboard) that is a possible failure point in the MAS. Some distributed architectures proposed distributed blackboards but they were soon abandoned in the profit of direct interactions (see next section). The other limit of blackboards is that all agents perceive the whole environment. Distributed AI designers tried to propose other models in which each agent has a local view on the environment, as we did in the Money example with agents exchanging wealth on their own cell only.</p>
<p>Such model gave rise to <em>spacially-situated</em> agent systems in which agents move on a spatial model (generally, a two dimensions grid) that they can observe. The content of each cell can be a mini-blackboard or any other data structure. Here is a possible implementation of such an environment :</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Environment</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[{}</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">width</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">height</span><span class="p">)</span> <span class="p">]</span>
    <span class="k">def</span> <span class="nf">act</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">agent</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
        <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">][</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">def</span> <span class="nf">perceive</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">agent</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span> <span class="o">=</span> <span class="n">agent</span><span class="o">.</span><span class="n">get_current_position</span><span class="p">()</span>
        <span class="n">bb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grid</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">bb</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">bb</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">None</span>

<span class="k">class</span> <span class="nc">Agent</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">initial_position</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">initial_position</span>
    <span class="k">def</span> <span class="nf">get_current_position</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pos</span>
    <span class="k">def</span> <span class="nf">move</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">new_position</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pos</span> <span class="o">=</span> <span class="n">position</span>
    <span class="o">...</span>
</pre></div>
</div>
<p>The name <em>stigmergy</em> comes from the behaviour of some social insects such as ants or termites. Such animals drop pheromones in the environment as they move around. These pheromones give information to other members of the colony about their movements (where they were, how long ago they were here…) but also about what they were doing at that time (carrying food, hunting…). <strong>Spatially situated agent model with indirect interaction</strong> took their inspiration in this biological model.</p>
<p>One important characteristics of <em>stigmergy</em> is that the information contained in the pheromones fades away with time. Multiagent models that implement stigmergy generally have a similar mechanism to alter the value of some variables. This means that <strong>the environment also acts on its variable values</strong>. This can be used by agent to follow another agent’s track (using <a class="reference external" href="https://en.wikipedia.org/wiki/Gradient_descent">gradient descent</a>) or to improve space coverage by searching for spaces with lower values of pheromones.</p>
<p>Note that agents in stygmergic environments generally are <em>reactive agents</em> (although nothing forbids them from being cognitive, see session 1, section 2).</p>
<div class="section" id="practice-yourself-optional">
<h3>Practice yourself (optional)<a class="headerlink" href="#practice-yourself-optional" title="Permalink to this headline">¶</a></h3>
<p>If you have time, try to implement a stigmergic model of a simple multiagent systems in Python (without using the Mesa library):</p>
<ul class="simple">
<li><p>The environment is a 10x10 grid space. It offers methods to move randomly in any of the four possible directions.</p></li>
<li><p>The system runs in a synchronous manner.</p></li>
<li><p>Each cell has a value, initially set to 100 that decreases by 1 at each turn.</p></li>
<li><p>Agents can either move or remain on a cell at each turn. When they choose to remain, the value of the cell is increased by 10.</p></li>
<li><p>Agents try to maintain all cells values above 50.</p></li>
</ul>
<p>If you are good with graphical interfaces (<em>e.g.</em> tkinter), you can draw the grid’s values and embed your runtime in the graphical mainloop to observe the simulation.</p>
</div>
</div>
<div class="section" id="from-stigmergy-to-artefacts">
<h2>3. From Stigmergy to Artefacts<a class="headerlink" href="#from-stigmergy-to-artefacts" title="Permalink to this headline">¶</a></h2>
<p>In the early 2000s, researchers in MAS began to question the environment: How passive should it be? Since stigmergic environments change their values with time, what really makes them different from an agent on which other agents would act? What is the difference between an object (in the environment) and an agent?</p>
<p>All these questions gave rise to a model called <strong>Agents and Artifacts</strong>, proposed by <a class="reference external" href="http://lia.deis.unibo.it/~ao/pubs/pdf/submitted/e4masIII-rovgo.pdf">Alessandro Ricci and his colleagues from the University of Bologna</a>. The A&amp;A model became very popular because it unified different theories and proposed a clear distinction between objects, services and agents. Understanding all subtleties of A&amp;A is out of the scope of this course and only few platforms use this model. However, its theoretical value is of importance.</p>
<p>To make a long story short, the environment in A&amp;A is a set of <em>artifacts</em> which behave like reactive services. Each artifact has a set of variables that can be modified by agents (inputs), and a set of variables that can be observed by agents (outputs). Agents can create artifacts in the environment and tag them for other agents to notice them. Whenever an agent sets input values to the artifact, it begins its computation in an asynchronous manner <em>w.r.t.</em> other agents or artifacts. When this computation is over, it informs the initiator agent. Moreover, artifacts have some documentation (<em>e.g.</em> using the <a class="reference external" href="https://www.w3.org/TR/wsdl20-primer/">Web Service Description Language</a>) for agents to interact with them without a priori knowledge. However artifacts are not <strong>autonomous</strong>, contrary to agents: they simply compute whatever is requested, they have no internal decision mechanism.</p>
<div class="section" id="conclusion-on-indirect-interactions">
<h3>Conclusion on Indirect Interactions<a class="headerlink" href="#conclusion-on-indirect-interactions" title="Permalink to this headline">¶</a></h3>
<p>Indirect interactions is still largely used, especially in Multi-Agent Based Simulation (as you did in the Prey-Predator simulation during the previous session). However, the most widespread interaction model in multiagent platforms (thanks to the <a class="reference external" href="http://www.fipa.org/">FIPA stantard</a>) is based on <em>direct interactions</em> that we present in the next section.</p>
</div>
</div>
</div>
<div class="section" id="direct-interactions">
<h1>3.2. Direct interactions<a class="headerlink" href="#direct-interactions" title="Permalink to this headline">¶</a></h1>
<div class="section" id="the-theory">
<h2>1. The Theory<a class="headerlink" href="#the-theory" title="Permalink to this headline">¶</a></h2>
<p>Direct interactions in multiagent systems relies on a very strong assumption: the <strong>intention</strong> to communicate. Whereas agents in a stigmergic environment do not explicitely communicate, direct interactions means that agents know they are exchanging information with another agent. They control the communication.</p>
<p>The first consequence is that communication is done by <strong>sending messages</strong> from an agent to another (or to a group or others). There are a couple of theories that you need to understand before we actually implement direction communication in a MAS.</p>
<div class="section" id="communication-levels">
<h3>Communication levels<a class="headerlink" href="#communication-levels" title="Permalink to this headline">¶</a></h3>
<p>Communication has been widely studied in mathematics and computer science in the second half of the XXst Century, after the publication of Claude Shannon’s <a class="reference external" href="https://dl.acm.org/doi/pdf/10.1145/584091.584093">A Mathematical Theory of Communication</a> in 1948. One main contribution in the 70s is the <a class="reference external" href="https://en.wikipedia.org/wiki/OSI_model">Open Systems Interconnection (OSI) model</a> that is now an ISO standard for computer networked systems, with 7 layers to describe the communication. However other models were proposed to study all sorts of communications.</p>
<p>Let us first take a look at some of these communication layers:</p>
<ul class="simple">
<li><p>The <strong>physical</strong> layer which is responsible for the transport of the message from one agent to another. Human beings cannot talk without ambiant air. Bees require visual space to perform their “dance” that indicates flowers positions. Physical layers are always required, and MAS won’t be an exception;</p></li>
<li><p>The <strong>syntactic</strong> layer which defines how elements of the message must be arranged. In human communication, we share grammatical rules that decide how sounds must be arranged to form words. Similarly, computer agents will require some message structure to ensure that they can communicate with each other. To this goal, we shall use a well-defined <em>Agent Communication Language</em> (ACL);</p></li>
<li><p>The <strong>knowledge</strong> layer which defines the <em>meaning</em> of the message content. Most of us hardly understand the meaning of bird songs, but ethnologists proved that birds can exchange different kinds of information with their songs. Same thing for the ants with their pheromones. And, of course, words in our language do have specific meanings that need to be shared among a group of people for them to understand each others. This is also true for agents: the content of the messages must be attached to so-called <em>ontologies</em> that define how these concepts relate to the agent’s activity.</p></li>
<li><p>The <strong>protocol</strong> layer which defines some rules for the communication. When you call a friend on the phone, when you write an email, people expect you to exchange some messages that have no other purpose than establishing the communication (<em>e.g.</em> saying hello, saying goodbye, <em>etc</em>). Similarly, MAS engineering requires to define communication protocols for the agents to be able to perform the task the system was designed for.</p></li>
</ul>
<p>In the following subsections, we will see how these layers are achieved in agent communication models.</p>
</div>
<div class="section" id="speech-acts-theory">
<h3>Speech Acts Theory<a class="headerlink" href="#speech-acts-theory" title="Permalink to this headline">¶</a></h3>
<p>The most important model for agent communication was not designed by a computer scientist. It is the <em>Speech Acts Theory</em> that was invented in 1955 by the philosopher John L. Austin and described in his famous book <a class="reference external" href="https://pure.mpg.de/rest/items/item_2271128_6/component/file_2271430/content">How to do things with words</a>. Austin’s work was pursued in the 60s by <a class="reference external" href="https://www.jstor.org/stable/2183008?seq=1">John R. Searle</a>, another philosopher that largely contributed to computer science and linguistics.</p>
<p>Austin’s proposal is that communication is a way to change one’ interlocutor state of mind. When I write (or say) “Elephants are pink”, I change your belief base. If you have no knowledge in Biology, I will have added the belief that elephants are pink in your mind. I <strong>made you believe that elephants are pink</strong>. If you have a more critical view on my knowledge about elephants, I will have at least <strong>made you believe that I think that elephants are pink</strong>. And even if none of this happen, I’ll have <strong>made you believe that I said that elephants are pink</strong>. To make a long story short, when I communicate, I change your beliefs. Therefore, this is an <strong>action</strong> on your beliefs base. Hence the name: speech <strong>acts</strong> theory, which says that communication is a form of action.</p>
<p>Austin first identified three aspects of communication, <em>i.e.</em> three speech acts or <em>locutions</em>. The first one is the <strong>locutionary act</strong>. It is the action of producing a meaningful sentence. In my elephant example, saying that elephants are pink has some meaning, regardless from the actual truth of the assertion. The second (and most important for us) aspect is the <strong>illocutionary act</strong>. This is what is intended by the sender of the message. In my elephant example, it could be to inform you about some Biological knowledge, or to illustrate an example, or to amuse you. When you say “How are you doing?”, the illocutionary act is either a traditional politeness formula or to obtain some information from your interlocutor about its current state. This is what agents will do in the MAS for direct communication. The last aspect of communication is the <strong>perlocutionary act</strong>, which is what is actually obtained from the communication. In MAS, we will generally assume that the communication is completely successful, <em>i.e.</em> that the perlocutionary act is equal to the illocutionary act.</p>
<p>John Searle’s main contribution to this theory was to identify different categories of illocutionary acts. Searle propose to distinguish between:</p>
<ul class="simple">
<li><p><strong>Assertive</strong> acts to send information: <em>Elephants are pink</em></p></li>
<li><p><strong>Directive</strong> acts to request for some action: <em>Could you open the window?</em>, <em>What time is it?</em> (in this second example, the requested action is that you tell me the time)</p></li>
<li><p><strong>Commissive</strong> acts to commit to some action’s achievement: <em>I’ll do it!</em></p></li>
<li><p><strong>Declaration</strong> acts to control the protocol: <em>I declare that today’s session is over!</em>, <em>Hello!</em></p></li>
<li><p><strong>Expressive</strong> acts: <em>I feel sad today.</em></p></li>
</ul>
</div>
<div class="section" id="performative-and-contents">
<h3>Performative and contents<a class="headerlink" href="#performative-and-contents" title="Permalink to this headline">¶</a></h3>
<p>Based on this, the speech acts theory propose to consider an illocutionary locution as a couple <strong>(Performative,Content)</strong> in which the performative defines the interpretation of the content.</p>
<p>Let us consider a concrete example with a computer-science perspective: if you consider the content <code class="docutils literal notranslate"><span class="pre">raining=True</span></code>, you can use it in different manner:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Assert(raining=true)</span></code>: the agent will inform the message’s recipient that it is raining;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Question(raining=true)</span></code>: the agent wants to know whether it is raining or not;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Order(raining=true)</span></code>: the agent wants that its interlocutor starts the rain (the good thing with computer science is that it does not need to be realistic… :-));</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Commit(raining=true)</span></code>: the agent commits to the value of <code class="docutils literal notranslate"><span class="pre">raining</span></code> at some point in the future;</p></li>
<li><p><em>etc.</em></p></li>
</ul>
<p>In multiagent systems, we will define a series of <em>performatives</em> that all must have a very precise effect on the receiver’s beliefs base. The definition of these performatives is part of the software engineering of the MAS.</p>
</div>
<div class="section" id="the-fipa-agent-communication-language-acl">
<h3>The FIPA Agent Communication Language (ACL)<a class="headerlink" href="#the-fipa-agent-communication-language-acl" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference external" href="http://fipa.org/">Fundation for Intelligent Physical Agents (FIPA)</a> is an IEEE organisation that defined some standards for MAS design. In this course, we shall consider three of their contributions:</p>
<ul class="simple">
<li><p>The FIPA-ACL model, which defines the structure of messages;</p></li>
<li><p>The FIPA performatives, which defines 22 performatives with their semantics;</p></li>
<li><p>The AUML protocol description model, which specifies how message exchanges should be presented from a software engineering point of view.</p></li>
</ul>
<p>The FIPA-ACL model defines the possible fields of a message in direct communication models. Four fields are of outmost importance:</p>
<ul>
<li><p><strong>ID of the message sender</strong>: each message has a unique sender agent ID. This can be used by receivers to answer to this message.</p>
<p>Note that you do not send a pointer to the agent, only its idea. The idea is that an agent never accesses its interlocutor’s variable or methods directly. As we will see in a few moments, direct communication mechanisms relies only on agents ids.</p>
</li>
<li><p><strong>List of IDs of the message recipients</strong>.</p>
<p>Some platform support message broadcasting (using special ids with wildcard characters) but this is not the common rule. In most platforms, the system is provided with a <em>Directory Facilitator</em> that serves as a yellow-pages server. Each agent registers to the DF with the name of the services it can offer (as we will see in the next subsection, these services correspond to <em>roles</em> in the MAS <em>protocols</em>) with its ID, so that other agents can obtain the list of agents that can offer a given service by requesting the DF.</p>
</li>
<li><p><strong>Message performative</strong> selected in the list of performatives that this MAS supports.</p></li>
<li><p><strong>Message content</strong> using a syntax that is common to all agents in the MAS (for example, RDF triples, logical formulaes, <code class="docutils literal notranslate"><span class="pre">(name,value)</span></code> pairs, <em>etc</em>).</p></li>
</ul>
<p>ACL messages have other optional fields such as:</p>
<ul class="simple">
<li><p>A reference to the language used for the content (this allow loosely-coupled MAS to communicate with heterogeneous syntactic languages, as long as there is some conversion rule from one language to another);</p></li>
<li><p>A reference to the ontology used for the content (this allows semantic heterogeneity between agents);</p></li>
<li><p>The conversation id, to allow agents to participate in several protocols at a time without loosing track of the exchanges;</p></li>
</ul>
</div>
</div>
<div class="section" id="direct-interactions-implementation">
<h2>2. Direct interactions implementation<a class="headerlink" href="#direct-interactions-implementation" title="Permalink to this headline">¶</a></h2>
<p>That was quite a long theoretical part for today. Let us now discuss how all this can be implemented in a MAS platform.</p>
<p>Here is what we <strong>cannot</strong> do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Environment</span><span class="p">:</span>
    <span class="o">...</span> <span class="n">environment</span> <span class="n">definition</span> <span class="o">...</span>

<span class="k">class</span> <span class="nc">Agent</span><span class="p">():</span>
    <span class="o">...</span> <span class="n">agent</span> <span class="n">definition</span> <span class="o">...</span>
    <span class="o">...</span> <span class="n">procedural</span> <span class="n">loop</span> <span class="o">...</span>

    <span class="k">def</span> <span class="nf">receive</span><span class="p">(</span><span class="n">message</span><span class="p">):</span>
        <span class="o">...</span> <span class="n">what</span> <span class="n">to</span> <span class="n">do</span> <span class="k">with</span> <span class="n">the</span> <span class="n">message</span> <span class="o">...</span>
</pre></div>
</div>
<p>By doing so, we would have agents that work in a synchronous manner: the sender’s execution would have to end the termination of the <code class="docutils literal notranslate"><span class="pre">receive</span></code> method on the recipient’s side before it can continue its own execution.</p>
<p>To overcome this limitation, computer scientist use a four step mechanism illustrated on the figure below:</p>
<img alt="_images/messages.png" class="align-center" src="_images/messages.png" />
<ol class="arabic">
<li><p>The sender agent builds the message;</p></li>
<li><p>The sender agents invokes a <code class="docutils literal notranslate"><span class="pre">send</span></code> method in the environment to send the message, as one of its actions;</p>
<p>This method returns immediately. The agent can now continue its procedural loop. It is assumed, from his point of view, that the recipient agent has received the message.</p>
</li>
<li><p>The environment drops the message in the mailbox of the agent. This can be done either:</p>
<ul class="simple">
<li><p>In a synchronous manner as part of the <code class="docutils literal notranslate"><span class="pre">send</span></code> method: when method returns, the message is actually in the recipient’s mailbox; or</p></li>
<li><p>In an asynchronous manner: the <code class="docutils literal notranslate"><span class="pre">send</span></code> method simply stores the message in the environment. The code that drops the message in the mailboxes will be invoked later (either as part of an environment’s thread or, if the MAS is synchronous, at each time step).</p></li>
</ul>
<p>In both cases, the <code class="docutils literal notranslate"><span class="pre">send</span></code> method does not block the sender.</p>
</li>
<li><p>The receiver agent reads its mailbox, either in a systematic manner as part of the perception mechanism in the procedural loop (<em>passive perception</em>) or on purpose, by calling a specific method (<em>active perception</em>).</p>
<p>Active perception is much more common than passive one, because it is much easier to use for the MAS programmer.</p>
</li>
</ol>
<p>You shall not be surprised by this mechanism, since it is very close to a blackboard model… except that agents drop messages on the blackboard and only receive their messages (it is generally assumed that agents cannot overhear the other agent’s message, although this is not of importance in most MAS models).</p>
<div class="section" id="concrete-implementation">
<h3>Concrete implementation<a class="headerlink" href="#concrete-implementation" title="Permalink to this headline">¶</a></h3>
<p>Let us implement this mechanism in a Python MAS. By doing so, we begin to write a MAS platform. The reason why most people use existing libraries, APIs and platforms is to avoid to implement this again and again.</p>
<p>At this point of the course, we need to consider two aspects:</p>
<ol class="arabic simple">
<li><p>In a MAS with direct interactions, there is no need to distinguish between the environment and the runtime (as we did for indirect interactions). Indeed, there is no such thing as “shared” variables that would be accessible to all agents. On the contrary, each agent only has access to its own internal variables… and messages for other agents. The perception and action phases in the procedural loop are reduced to message sending.</p></li>
</ol>
<p>(<em>This is not entirely true since you will certainly use</em> <code class="docutils literal notranslate"><span class="pre">print</span></code> <em>statements for debugging issues, and a</em> <code class="docutils literal notranslate"><span class="pre">print</span></code> <em>statement in the procedural loop is a form of action in the environment</em>)</p>
<ol class="arabic simple" start="2">
<li><p>We are no longer implementing one single MAS example, but we are considering generic mechanisms for agent communications. To this goal, we need to separate the agent platform from the agent model. Concretely, we wand to implement generic <code class="docutils literal notranslate"><span class="pre">Agent</span></code> and <code class="docutils literal notranslate"><span class="pre">Environement</span></code> classes. As was done in session 1 (section 4) with the Mesa library, the classes in your MAS will inherit these generic classes.</p></li>
</ol>
</div>
<div class="section" id="question-1-some-degree-of-genericity">
<h3>Question 1: some degree of genericity<a class="headerlink" href="#question-1-some-degree-of-genericity" title="Permalink to this headline">¶</a></h3>
<p>Using either synchronous or asynchronous mechanisms, write generic <code class="docutils literal notranslate"><span class="pre">Agent</span></code> and <code class="docutils literal notranslate"><span class="pre">Environment</span></code> classes that could be used to implement a simple Alice-Bob example. The <code class="docutils literal notranslate"><span class="pre">Environment</span></code> class should include the scheduler and <code class="docutils literal notranslate"><span class="pre">start</span></code>/<code class="docutils literal notranslate"><span class="pre">stop</span></code> methods, but it should not propose any perception and action mechanism for now.</p>
<p>Here is the code’s skeleton:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">time</span>

<span class="k">class</span> <span class="nc">Environment</span><span class="p">:</span>

    <span class="c1"># ... to be continued ...</span>

<span class="k">class</span> <span class="nc">Agent</span><span class="p">:</span>

    <span class="c1"># ... to be continued ...</span>

<span class="k">class</span> <span class="nc">AliceBob</span><span class="p">(</span><span class="n">Agent</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">env</span><span class="p">,</span> <span class="n">pv</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferred_value</span> <span class="o">=</span> <span class="n">pv</span>
    <span class="k">def</span> <span class="nf">procedural_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># nothing to do for now</span>

<span class="n">e</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">()</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">AliceBob</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">AliceBob</span><span class="p">(</span><span class="n">e</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="n">e</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="question-2-messages">
<h3>Question 2: Messages<a class="headerlink" href="#question-2-messages" title="Permalink to this headline">¶</a></h3>
<p>Let us create a generic <code class="docutils literal notranslate"><span class="pre">Message</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Message</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">performative</span><span class="p">,</span><span class="n">sender_id</span><span class="p">,</span><span class="n">content</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">perf</span> <span class="o">=</span> <span class="n">performative</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sender</span> <span class="o">=</span> <span class="n">sender_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dest</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">set_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">content</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">content</span> <span class="o">=</span> <span class="n">content</span>
    <span class="k">def</span> <span class="nf">add_receiver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">agent_id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dest</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">agent_id</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">get_content</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">content</span>
    <span class="k">def</span> <span class="nf">get_performative</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">perf</span>
    <span class="k">def</span> <span class="nf">get_sender</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span>
    <span class="k">def</span> <span class="nf">get_receivers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dest</span>
</pre></div>
</div>
<p>Note that the content is optional in the constructor (some messages have an empty content).</p>
<ol class="arabic simple">
<li><p>Based on this new class, implement a <code class="docutils literal notranslate"><span class="pre">send</span></code> method in the <code class="docutils literal notranslate"><span class="pre">Environement</span></code> class (which will now be responsible for the agent execution <strong>and</strong> for the transport of messages).</p></li>
<li><p>Also write a <code class="docutils literal notranslate"><span class="pre">send</span></code> method in the generic <code class="docutils literal notranslate"><span class="pre">Agent</span></code> class to call the environment’s one (that is syntactic sugar).</p></li>
<li><p>Implement a <code class="docutils literal notranslate"><span class="pre">receive</span></code> method in the generic <code class="docutils literal notranslate"><span class="pre">Agent</span></code> class that allows to retrieve the message in the mailbox.</p></li>
</ol>
<p>The correction is given below, so that you can continue the session. But you really should try to do it yourself!</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Environment</span><span class="p">:</span>
    <span class="n">agents</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="nb">id</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">l</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">add_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">agent</span><span class="p">):</span>
        <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">l</span><span class="p">:</span>
            <span class="n">s</span> <span class="o">=</span> <span class="s2">&quot;agent&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">id</span><span class="o">+=</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">[</span><span class="n">s</span><span class="p">]</span><span class="o">=</span><span class="n">agent</span>
        <span class="k">return</span> <span class="n">s</span>
    <span class="k">def</span> <span class="nf">start</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">message</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">get_sender</span><span class="p">())</span><span class="o">+</span><span class="s2">&quot; -&gt; &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">get_receivers</span><span class="p">())</span><span class="o">+</span><span class="s2">&quot; : &quot;</span><span class="o">+</span> \
              <span class="nb">str</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">get_performative</span><span class="p">())</span><span class="o">+</span><span class="s2">&quot;(&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">message</span><span class="o">.</span><span class="n">get_content</span><span class="p">())</span><span class="o">+</span><span class="s2">&quot;)&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">message</span><span class="o">.</span><span class="n">get_receivers</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">agents</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span><span class="o">.</span><span class="n">append_message</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Agent</span><span class="p">(</span><span class="n">Thread</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">env</span><span class="p">):</span>
        <span class="n">Thread</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">env</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">add_agent</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mailbox</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">get_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>
    <span class="k">def</span> <span class="nf">run</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">while</span> <span class="bp">self</span><span class="o">.</span><span class="n">running</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">procedural_loop</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">procedural_loop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span> <span class="c1"># will be overridden</span>
        <span class="k">pass</span>
    <span class="k">def</span> <span class="nf">stop</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">running</span> <span class="o">=</span> <span class="bp">False</span>
    <span class="k">def</span> <span class="nf">append_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">message</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">message</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">message</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">receive</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">l</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mailbox</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">l</span>
</pre></div>
</div>
</div>
<div class="section" id="question-3-concrete-example">
<h3>Question 3: Concrete example<a class="headerlink" href="#question-3-concrete-example" title="Permalink to this headline">¶</a></h3>
<p>Based on this, we can create a third agent name <code class="docutils literal notranslate"><span class="pre">Charles</span></code> whose role is hold a variable <code class="docutils literal notranslate"><span class="pre">v</span></code> and to process messages from Alice and Bob:</p>
<ul class="simple">
<li><p>On their turn, Alice and Bob ask Charles for the value of <code class="docutils literal notranslate"><span class="pre">v</span></code>, using a message;</p></li>
<li><p>If the value is different from their preferred value, they send a message to Charles to change the value of <code class="docutils literal notranslate"><span class="pre">v</span></code>;</p></li>
<li><p>On its turn, Charles reads its mailbox and processes all messages:</p>
<ul>
<li><p>Messages that request information about <code class="docutils literal notranslate"><span class="pre">v</span></code> produce an anwer;</p></li>
<li><p>Messages that request a change to <code class="docutils literal notranslate"><span class="pre">v</span></code> are applied.</p></li>
</ul>
</li>
</ul>
<p>Before jumping into the implementation, answer the following questions:
1. What will be the performative for asking Charles the value of <code class="docutils literal notranslate"><span class="pre">v</span></code>? What will be the content (note that empty contents are always allowed)?
2. What will be the performative for telling Alice or Bob the value of <code class="docutils literal notranslate"><span class="pre">v</span></code>? What will be the content?
3. What will be the performative for asking Charles to change the value of <code class="docutils literal notranslate"><span class="pre">v</span></code>? What will be the content?
4. Implement the Alice-Bob-Charles example.</p>
</div>
</div>
</div>
<div class="section" id="engineering-interactions">
<h1>3.3. Engineering interactions<a class="headerlink" href="#engineering-interactions" title="Permalink to this headline">¶</a></h1>
<p>Before we move to the next section and the implementation of direct communication in Mesa, you need some information about direction interaction engineering.</p>
<p>As explained above, MAS engineering requires to define two things when it comes to direction communication:</p>
<ul class="simple">
<li><p>The list of <em>performatives</em> with their precise semantics;</p></li>
<li><p>The <em>communication protocols</em> that will be used by your agents.</p></li>
</ul>
<div class="section" id="performatives">
<h2>1. Performatives<a class="headerlink" href="#performatives" title="Permalink to this headline">¶</a></h2>
<p>The first thing to consider when you design a MAS with direct interactions is the list of <em>performatives</em> and associated <em>message content types</em> that will be used in your communication model. In the Alice, Bob and Charles example, we have three types of messages: questions about the value of Charle’s internal variable, answers about the value of this variable, orders to change the value. There are at least four different solutions for engineering this interaction. What matters is the <strong>semantics</strong> we give to each performative.</p>
<p>The semantics of the performatives define the belief base for both the sender and the receiver of a message. Let us consider the Alice, Bob and Charles example and the case <em>Alice sends a message to Charles to ask the value of variable ``v``</em>. We can achieve this with a performative <code class="docutils literal notranslate"><span class="pre">question-variable</span></code> with the following semantics:</p>
<ul class="simple">
<li><p>The content of the message must be a <code class="docutils literal notranslate"><span class="pre">String</span></code> that is the name of a variable;</p></li>
<li><p>From the sender agent’s point of view, before sending the message (these are the <em>preconditions</em> of the performative):</p>
<ul>
<li><p>The agent is unsure about the value of the variable;</p></li>
<li><p>The agent beliefs that the recipient has the value of the variable in its belief base;</p></li>
<li><p>The agent intends to tell the recipient that it wants to be told about this value.</p></li>
</ul>
</li>
<li><p>And from the receiver agent’s point of view, upon reception of the message (these are the <em>postconditions</em> of the performative):</p>
<ul>
<li><p>The agent beliefs that the sender is unsure about the value of the variable;</p></li>
<li><p>The agent beliefs that the sender agent expects it to send the value of the variable.</p></li>
</ul>
</li>
</ul>
<p>This make a lot of assumptions and they have strong consequences on the code. If you decide that <code class="docutils literal notranslate"><span class="pre">question-value</span></code> means that the sender agent is unsure about the value of the variable, you need some mechanism to change the beliefs of agents Alice and Bob so that they ask for the value again after they sent a <code class="docutils literal notranslate"><span class="pre">set-value</span></code> message. Otherwise, there is no reason for them sending a <code class="docutils literal notranslate"><span class="pre">question-value</span></code> message once they ordered a change. You can use a <strong>timeout</strong>, for instance, to remove the value of <code class="docutils literal notranslate"><span class="pre">v</span></code> from the Alice and Bob’s belief bases after some time.</p>
<p>It is very unlikely that you implemented such a complex mechanism in your model. But that’s ok: it all depends on the semantics of your performatives. For instance, we could have defined a much more simple interaction model:</p>
<ul class="simple">
<li><p>We still use 3 performatives: <code class="docutils literal notranslate"><span class="pre">question-v</span></code>, <code class="docutils literal notranslate"><span class="pre">assert-v</span></code> and <code class="docutils literal notranslate"><span class="pre">set-value</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">question-v</span></code> requires no content. It makes no assumption on the sender’s belief base (no precondition), but its postcondition is that the receiver intends to send the value of <code class="docutils literal notranslate"><span class="pre">v</span></code>;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">assert-v</span></code> has the value as content. It assumes that the sender agent has a belief about the value of <code class="docutils literal notranslate"><span class="pre">v</span></code> as a precondition (and, of course, that the value is the content of the message), and that the receiver agent believes the new value of <code class="docutils literal notranslate"><span class="pre">v</span></code> (as a postcondition).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set-v</span></code> has the value as content. It assumes that the sender agent believes the value of <code class="docutils literal notranslate"><span class="pre">v</span></code> not to be the one sent as content (precondition) and it has two postconditions: the receiver agent changes the value of <code class="docutils literal notranslate"><span class="pre">v</span></code> and the sender agent believes that the value is now what was requested.</p></li>
</ul>
<p>In this model, although there are some assumptions about a coherence between the sender and receiver in the case of <code class="docutils literal notranslate"><span class="pre">set-v</span></code> messages, there is no precondition for <code class="docutils literal notranslate"><span class="pre">question-v</span></code> messages: the agent can send it whenever it wants to. The advantage is that it is much simpler to implement. The drawbacks are twofold:</p>
<ul class="simple">
<li><p>The model lacks genericity (it can only be used in a MAS with agents that share information about a variable <code class="docutils literal notranslate"><span class="pre">v</span></code> they all know of: this is a very specific case of tightly coupled MAS);</p></li>
<li><p>The agents will certainly spam each other with <code class="docutils literal notranslate"><span class="pre">question-v</span></code> messages since there is no precondition to this message.</p></li>
</ul>
<p>As a conclusion, engineering MAS interactions is not an easy task. You need to find the correct balance between very generic models that will require a lot of code to work and too specific ones that miss the basic notions of MAS. Some solid theoretical tools exist in the MAS literature to help programmers in this task. One of them is the <a class="reference external" href="http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.93.8441&amp;rep=rep1&amp;type=pdf">BDI logic</a> by Cohen and Levesque that we already referred to in the first session (section 1) of this course. By representing agents’ beliefs and intentions, it allows to describe precisely the effects of the performatives. This is the solution that was used by the FIPA to define the semantics of their 22 standard performatives. However, we will not detail these in this course (more information can be found <a class="reference external" href="http://www.fipa.org/specs/fipa00037/SC00037J.html">on this page</a>).</p>
</div>
<div class="section" id="communication-protocols">
<h2>2. Communication protocols<a class="headerlink" href="#communication-protocols" title="Permalink to this headline">¶</a></h2>
<p>In the <em>performative specification</em> task, we only define the message content, preconditions and postconditions in terms of agents beliefs: what is the structure of the message and how it relates to the belief base of the two agents. However, we did not define the <strong>structure of the interaction</strong>, <em>i.e.</em> how the message relate with each other. This must be define as <strong>communication protocols</strong>.</p>
<p>A <em>protocol</em> is a possible series of message exchanges (or interactions) between two or more agents to achieve a sub-task of the MAS. Engineers try to have these protocols as short as possible to as to keep control of what is actually done by the system. When engaging in a protocol, agents commit to provide the expected answers. They adopt a given <strong>role</strong> that defines what they can receive as message and what they can answer.</p>
<p>In our Alice-Bob-Charles example, we can consider two protocols:</p>
<ul>
<li><p>In the first protocol (let’s call it “Tell me the value of V”-protocol), one agent (taking the role of <em>initiator</em>) asks another agent (taking the role of <em>informator</em>) about the value of a variable. The initiator must send a <code class="docutils literal notranslate"><span class="pre">question-value</span></code> message with the name of the variable and the informator must answer to this message with a <code class="docutils literal notranslate"><span class="pre">assert-value</span></code> message.</p>
<p>Note that Charles is not the only agent that could serve as an informator. One could imagine that Alice and Bob adopt this role too. However, upon the MAS creation, we shall register Charles as the only agent that fulfils this role in the Directory Facilitator. Based on this, when other agents (Alice and Bob) ask the DF about which agent can achieve which role, they will only have Charles as a proposal. All their <code class="docutils literal notranslate"><span class="pre">question-value</span></code> will then be directed toward Charles.</p>
<p>Also note that the agents do not need to send message to each other to commit to the execution of a protocol. It is commonly admitted that <strong>all protocols start with a different message</strong> (ideally, a different performative, but a different <em>performative(content)</em> pair might do the trick) and that the receiver agent implicitly accepts to enter the protocol by answering the message accordingly (in our case, using an <code class="docutils literal notranslate"><span class="pre">assert-value</span></code> message).</p>
</li>
<li><p>The second protocol (let’s call it “Change your value”-protocol) is a very specific kind of protocol, that you rarely encounter in open, loosely coupled MAS. In this protocol, the <em>requester</em> agent simply sends a <code class="docutils literal notranslate"><span class="pre">set-value</span></code> message to the <em>participant</em> agent, and the protocols ends. There is not return message.</p>
<p>Note that, contrary to the first protocol, Charles is the only agent that could serve as a participant agent in this protocol. Since it has registered on the DF for this task, Alice and Bob can send him <code class="docutils literal notranslate"><span class="pre">set-value</span></code> message.</p>
</li>
</ul>
<p>It is important to distinguish between agents and roles in MAS. Several agents can play the same role (Alice, Bob and Charles can all play the role of informator) and several roles can be played by the same agent in different protocols (Charles can be an <em>informator</em> in the “Tell me the value of V”-protocol and a participant in the “Change your value”-protocol) or even in different instances of the same protocol (while there is no example in the ABC example, one can easily imagine a protocol with three roles for which one agent could hold two roles). <strong>You must define protocols with roles</strong>, not with agents.</p>
<p>Also keep in mind that protocols are small. There is no need to specify all the possible interactions of your MAS in one single protocol. On the contrary, keep each interaction separated so that you can control it. Protocol specifications only defines <strong>what the agents can answer</strong>, not the agent’s internal reasoning or conditions that decide for this answer! You must have these three layers in mind:</p>
<ul class="simple">
<li><p>Performative specification: what is a correct message content, under which conditions in the beliefs base can this message be sent, with which effects;</p></li>
<li><p>Protocol specification: what is expected as an answer to a given message, and what is not correct, based on the above specification;</p></li>
<li><p>MAS specification: what the agent actually answers, when and why, based on the above two specifications.</p></li>
</ul>
<p>Now that this is all clear in your mind, let’s see how we can write down such protocols.</p>
<div class="section" id="the-auml-model">
<h3>The AUML model<a class="headerlink" href="#the-auml-model" title="Permalink to this headline">¶</a></h3>
<p>The language used by multiagent software engineers for describing their protocols is called AUML, for Agent-UML. Actually, it is not a standard (contrary to UML, for which the specifications are <a class="reference external" href="https://www.omg.org/spec/UML/About-UML/">defined and maintained by the OMG</a>) and most of its proposed features are now part of the UML standard, which means that an AUML is very similar to a UML sequence diagram, with some exceptions:</p>
<ol class="arabic">
<li><p>Instead of classes as labels for each thread, you must use <strong>roles</strong> (and <em>not</em> agents);</p></li>
<li><p>There is not “execution block” that represents time: agents are <em>asychronous</em>;</p></li>
<li><p>Message passing are labeled with <strong>performatives</strong> (and, if necessary, contents);</p></li>
<li><p>Conditions for message passing will only be about the number of recipients and the presence of timeouts;</p>
<p>Indeed, the goal of an AUML diagram is not to define the <em>conditions</em> of each message selection, but only their agency : how many answers are expected, is there a timeout that conditions the execution, <em>etc</em>;</p>
</li>
<li><p>We shall use ALT, OPT and LOOP blocks to define the protocols.</p></li>
</ol>
<p>Here is a simple example of protocol:</p>
<img alt="_images/protocol1.png" class="align-center" src="_images/protocol1.png" />
<p>This protocol defines that teacher agents must answer with a “tell” performative when students send them an “ask” message. Now, let us consider a new version of the protocol:</p>
<img alt="_images/protocol2.png" class="align-center" src="_images/protocol2.png" />
<p>This protocol defines that students must answer with a “answer” performative to a “question” message sent by a teacher, and that they will receive a “reward” message in return. Now, we can add some constraints:</p>
<ol class="arabic">
<li><p>Only some students answer before a timeout:</p>
<blockquote>
<div><img alt="_images/protocol3.png" class="align-center" src="_images/protocol3.png" />
<p>Note that only agents that did answer before the timeout remain in the protocol. All other agents are ignored. They won’t receive the “reward” message.</p>
</div></blockquote>
</li>
<li><p>Only some of the students (who answered before the timeout) will receive the reward:</p>
<blockquote>
<div><img alt="_images/protocol4.png" class="align-center" src="_images/protocol4.png" />
<p>Note that <em>m</em> and <em>n</em> are not values: the conditions always remain at an abstract level. It is up to the agent to decide how many students it wants to reward, and for which reason.</p>
</div></blockquote>
</li>
<li><p>Another manner of writing the same protocol with the “optional” answer is to use an “OPT” block:</p>
<blockquote>
<div><img alt="_images/protocol5.png" class="align-center" src="_images/protocol5.png" />
</div></blockquote>
</li>
<li><p>The most commonly used block is however the ALT block with shows different options with conditions. For instance:</p>
<blockquote>
<div><img alt="_images/protocol6.png" class="align-center" src="_images/protocol6.png" />
</div></blockquote>
</li>
<li><p>And in that case, people often want to add conditions to the blocks:</p>
<blockquote>
<div><img alt="_images/protocol7.png" class="align-center" src="_images/protocol7.png" />
</div></blockquote>
<p>Here, the condition expresses that <em>all</em> agents that answered receive either an “success” or a “failure” message. No agent remains unanswered.</p>
</li>
<li><p>It is also possible to use the classical “choice” UML symbol to represent ALT blocks. This makes the protocol easier to read when you have blocks within blocks. Here is the famous “Contract Net” protocol proposed by FIPA, with 3 ALT blocks:</p>
<blockquote>
<div><div class="figure align-center" id="id1">
<img alt="_images/contractnet.jpeg" src="_images/contractnet.jpeg" />
<p class="caption"><span class="caption-text">The <cite>Contract Net Protocol &lt;http://www.fipa.org/specs/fipa00029/SC00029H.html&gt;</cite> defined by FIPA</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
</div></blockquote>
</li>
</ol>
<p>As a MAS engineer, you must always define the protocols that your agents will participate to, in addition to the list of performatives.</p>
</div>
<div class="section" id="question">
<h3>Question<a class="headerlink" href="#question" title="Permalink to this headline">¶</a></h3>
<p>Write down the AUML protocols that we implemented in the Alice-Bob-Charles examples.</p>
</div>
</div>
<div class="section" id="communication-in-mesa">
<h2>3. Communication in Mesa<a class="headerlink" href="#communication-in-mesa" title="Permalink to this headline">¶</a></h2>
<p>In the next section, you will see how to implement a message passing system in the Mesa Python library.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">3.1. Indirect interactions</a><ul>
<li><a class="reference internal" href="#blackboards">1. Blackboards</a></li>
<li><a class="reference internal" href="#from-blackboards-to-stigmergy">2. From Blackboards to Stigmergy</a><ul>
<li><a class="reference internal" href="#practice-yourself-optional">Practice yourself (optional)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#from-stigmergy-to-artefacts">3. From Stigmergy to Artefacts</a><ul>
<li><a class="reference internal" href="#conclusion-on-indirect-interactions">Conclusion on Indirect Interactions</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#direct-interactions">3.2. Direct interactions</a><ul>
<li><a class="reference internal" href="#the-theory">1. The Theory</a><ul>
<li><a class="reference internal" href="#communication-levels">Communication levels</a></li>
<li><a class="reference internal" href="#speech-acts-theory">Speech Acts Theory</a></li>
<li><a class="reference internal" href="#performative-and-contents">Performative and contents</a></li>
<li><a class="reference internal" href="#the-fipa-agent-communication-language-acl">The FIPA Agent Communication Language (ACL)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#direct-interactions-implementation">2. Direct interactions implementation</a><ul>
<li><a class="reference internal" href="#concrete-implementation">Concrete implementation</a></li>
<li><a class="reference internal" href="#question-1-some-degree-of-genericity">Question 1: some degree of genericity</a></li>
<li><a class="reference internal" href="#question-2-messages">Question 2: Messages</a></li>
<li><a class="reference internal" href="#question-3-concrete-example">Question 3: Concrete example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#engineering-interactions">3.3. Engineering interactions</a><ul>
<li><a class="reference internal" href="#performatives">1. Performatives</a></li>
<li><a class="reference internal" href="#communication-protocols">2. Communication protocols</a><ul>
<li><a class="reference internal" href="#the-auml-model">The AUML model</a></li>
<li><a class="reference internal" href="#question">Question</a></li>
</ul>
</li>
<li><a class="reference internal" href="#communication-in-mesa">3. Communication in Mesa</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="cours-3.html"
                        title="previous chapter">3. Interaction mechanisms : models and implementation</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="part-6.html"
                        title="next chapter">3.4. Interactions in the Mesa library</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/part-5.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="part-6.html" title="3.4. Interactions in the Mesa library"
             >next</a> |</li>
        <li class="right" >
          <a href="cours-3.html" title="3. Interaction mechanisms : models and implementation"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">MultiAgent Systems 2020-2021 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2020, Emmanuel Hermellin, Wassila Ouerdane, Nicolas Sabouret.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>